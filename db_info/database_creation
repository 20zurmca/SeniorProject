--Database Creation



--Goal 1, Step 1

CREATE TABLE roster_data ("roster_data.Roster_Year" INT, "roster_data.Player_Number" VARCHAR(20), "roster_data.First_Name" VARCHAR(50), "roster_data.Last_Name" VARCHAR(50),  "roster_data.Year" VARCHAR(10), "roster_data.Position1" VARCHAR(20), "roster_data.Position2" VARCHAR(20), "roster_data.Position3" VARCHAR(10), "roster_data.Height" VARCHAR(10), "roster_data.Weight" INT, "roster_data.Home_Town" VARCHAR(30), "roster_data.State_or_Country" VARCHAR(20), "roster_data.High_School" VARCHAR(100), "roster_data.Alternative_School" VARCHAR(50), "roster_data.College" VARCHAR(50), "roster_data.College_League" VARCHAR(50), "roster_data.Bio_Link" VARCHAR(100));

CREATE TABLE starter_data("starter_data.Roster_Year" INT, "starter_data.Number" INT, "starter_data.First_Name" VARCHAR(50), "starter_data.Last_Name" VARCHAR(50), "starter_data.Potential_Starts" INT, "starter_data.GP" INT, "starter_data.GS" INT, "starter_data.Is_Starter" VARCHAR(1), "starter_data.College" VARCHAR(50));

\COPY roster_data FROM 'roster_data.csv' DELIMITER ',' CSV HEADER;

\COPY starter_data FROM 'starter_data.csv' DELIMITER ',' CSV HEADER;


--Goal 1, Step 2

CREATE TABLE accolade_data("accolade_data.Roster_Year" INT, "accolade_data.First_Name" VARCHAR(50), "accolade_data.Last_Name" VARCHAR(50), "accolade_data.Accolade" VARCHAR(20), "accolade_data.College" VARCHAR(50));

\COPY accolade_data FROM 'accolades.csv' DELIMITER ',' CSV HEADER;


--Goal 1, Step 1

CREATE TABLE roster_starter_data AS (
	SELECT "roster_data.Roster_Year", "roster_data.Player_Number", "roster_data.First_Name", "roster_data.Last_Name", "roster_data.Year", "roster_data.Position1", "roster_data.Position2", "roster_data.Position3", "roster_data.Height", "roster_data.Weight", "roster_data.Home_Town", "roster_data.State_or_Country", "roster_data.High_School", "roster_data.Alternative_School", "roster_data.College", "roster_data.College_League", "roster_data.Bio_Link", "starter_data.Potential_Starts", "starter_data.GP", "starter_data.GS", "starter_data.Is_Starter" 
	FROM roster_data 
	LEFT JOIN starter_data 
	ON "roster_data.First_Name"="starter_data.First_Name" AND "roster_data.Last_Name"="starter_data.Last_Name" AND "roster_data.Roster_Year"="starter_data.Roster_Year" AND "roster_data.College"="starter_data.College"
);


--Goal 1, Step 2

CREATE TABLE roster_master_data AS (
	SELECT "roster_data.Roster_Year", "roster_data.Player_Number", "roster_data.First_Name", "roster_data.Last_Name", "roster_data.Year", "roster_data.Position1", "roster_data.Position2", "roster_data.Position3", "roster_data.Height", "roster_data.Weight", "roster_data.Home_Town", "roster_data.State_or_Country", "roster_data.High_School", "roster_data.Alternative_School", "roster_data.College", "roster_data.College_League", "roster_data.Bio_Link", "starter_data.Potential_Starts", "starter_data.GP", "starter_data.GS", "starter_data.Is_Starter", "accolade_data.Accolade" 
	FROM roster_starter_data 
	LEFT JOIN accolade_data 
	ON "roster_data.First_Name"="accolade_data.First_Name" AND "roster_data.Last_Name"="accolade_data.Last_Name" AND "roster_data.Roster_Year"="accolade_data.Roster_Year" AND "roster_data.College"="accolade_data.College"
);


--Goal 1, Step 3

DROP TABLE roster_data;
DROP TABLE starter_data;
DROP TABLE accolade_data;
DROP TABLE roster_starter_data;


--Goal 1, Step 4

ALTER TABLE roster_master_data RENAME COLUMN "roster_data.Roster_Year" TO Roster_Year;
ALTER TABLE roster_master_data RENAME COLUMN "roster_data.First_Name" TO First_Name;
ALTER TABLE roster_master_data RENAME COLUMN "roster_data.Last_Name" TO Last_Name;
ALTER TABLE roster_master_data RENAME COLUMN "roster_data.Year" TO Year;
ALTER TABLE roster_master_data RENAME COLUMN "roster_data.Position1" TO Position1;
ALTER TABLE roster_master_data RENAME COLUMN "roster_data.Position2" TO Position2;
ALTER TABLE roster_master_data RENAME COLUMN "roster_data.Position3" TO Position3;
ALTER TABLE roster_master_data RENAME COLUMN "roster_data.Height" TO Height;
ALTER TABLE roster_master_data RENAME COLUMN "roster_data.Weight" TO Weight;
ALTER TABLE roster_master_data RENAME COLUMN "roster_data.Home_Town" TO Home_Town;
ALTER TABLE roster_master_data RENAME COLUMN "roster_data.State_or_Country" TO State_or_Country;
ALTER TABLE roster_master_data RENAME COLUMN "roster_data.High_School" TO High_School;
ALTER TABLE roster_master_data RENAME COLUMN "roster_data.Alternative_School" TO Alternative_School;
ALTER TABLE roster_master_data RENAME COLUMN "roster_data.College" TO College;
ALTER TABLE roster_master_data RENAME COLUMN "roster_data.College_League" TO College_Leaguel;
ALTER TABLE roster_master_data RENAME COLUMN "roster_data.Bio_Link" TO Bio_Link;
ALTER TABLE roster_master_data RENAME COLUMN "starter_data.Potential_Starts" TO Potential_Starts;
ALTER TABLE roster_master_data RENAME COLUMN "starter_data.GP" TO GP;
ALTER TABLE roster_master_data RENAME COLUMN "starter_data.GS" TO GS;
ALTER TABLE roster_master_data RENAME COLUMN "starter_data.Is_Starter" TO Is_Starter;
ALTER TABLE roster_master_data RENAME COLUMN "accolade_data.Accolade" TO Accolade;


-- \Copy roster_master_data to 'roster_master_data.csv' DELIMITER ',' CSV HEADER;

